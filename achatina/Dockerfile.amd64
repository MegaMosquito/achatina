FROM python:3.7-alpine

RUN apk update && apk add --no-cache \
  mosquitto-clients \
  jq \
  librdkafka \
  yajl \
  && rm -fr /tmp/*

# Copy over the kafka installation
COPY --from=edenhill/kafkacat:1.6.0 /usr/bin/kafkacat /usr/local/bin/kafkacat

# Install requests (REST API client)
RUN pip install requests

# Copy over the source
COPY achatina.py /
WORKDIR /

# Run the daemon
CMD python achatina.py
